# 我的申请页面更新总结

## 更新内容

### 1. 导航菜单更新
**文件**: `src/layout/DefaultLayout.vue`
- 将"主体管理"菜单项改为"我的申请"
- 保持路由路径不变 (`/manage/servicer`)

### 2. 页面功能重新设计
**文件**: `src/views/manage/servicer/index.vue`
- 完全重写页面内容，从管理员管理页面改为用户申请记录页面
- 页面标题：我的申请
- 页面描述：查看您的服务主体申请记录和状态

### 3. 新增功能特性

#### 3.1 搜索功能
- 主体名称搜索
- 申请状态筛选（审核状态）
- 准入状态筛选
- 搜索和重置按钮

#### 3.2 操作功能
- **新增申请**：跳转到申请页面
- **查看详情**：查看申请的完整信息
- **编辑申请**：仅限审核中的申请
- **删除申请**：仅限审核中的申请

#### 3.3 申请记录表格
显示字段：
- 申请编号
- 主体名称
- 组织类型
- 联系人电话
- 法人代表
- 申请状态（审核状态）
- 准入状态
- 申请时间
- 审核时间
- 操作按钮

#### 3.4 详情查看对话框
显示完整的申请信息：
- 基本信息（名称、类型、联系方式等）
- 服务信息（种类、区域、介绍等）
- 图片信息（Logo、营业执照、主体图片）
- 经营数据（人数、收入、服务量等）
- 状态信息（申请状态、准入状态、审核意见）
- 时间信息（申请时间、审核时间）

#### 3.5 编辑申请对话框
- 支持编辑所有申请字段
- 表单验证
- 仅限审核中的申请可编辑

### 4. API 接口更新
**文件**: `src/api/apply/servicer.js`
- 新增 `listMyServicerApply` 函数
- 用于查询当前用户的申请记录列表
- 暂时使用 `/subject/servicer/my` 接口

### 5. 路由配置更新
**文件**: `src/router/index.js`
- 更新路由名称：`ServicerManage` → `MyServicerApply`
- 更新页面标题：`服务主体管理` → `我的申请`

## 数据库字段映射

根据提供的 `es_servicer_apply` 表结构，页面支持以下字段：

### 基本信息
- `id`: 申请编号
- `name`: 主体名称
- `type_id`: 组织类型ID
- `account_phone`: 联系人电话
- `corporate`: 法人代表

### 服务信息
- `service_type_xx`: 服务种类详情
- `service_type_path`: 服务种类路径
- `region_pre`: 省市县区镇
- `region_xx`: 详细地址
- `region_id`: 服务区域路径
- `introduce`: 主体介绍

### 图片信息
- `logo`: 主体Logo
- `video`: 主体视频
- `manage_cert`: 营业执照
- `picture_urls`: 主体图片URL

### 经营数据
- `population`: 从业人数
- `income`: 年服务营业收入
- `serve_num`: 服务对象数
- `farmers_num`: 服务小农户数
- `serve_area`: 年服务面积
- `raise_num`: 年畜牧服务量
- `water_num`: 年水产服务量
- `other_num`: 其他行业服务总量
- `crop_area`: 服务粮食作物面积

### 状态信息
- `audit_status`: 审核状态（0通过，1不通过，2审核中）
- `is_auth`: 准入状态（0未准入，1已准入，2审核中）
- `manage_status`: 经营状态（0正常，1异常）
- `audit_remark`: 审核意见
- `audit_user_id`: 审核人ID
- `audit_time`: 审核时间

### 时间信息
- `create_time`: 创建时间
- `update_time`: 更新时间

## 用户权限控制

### 编辑权限
- 仅限 `audit_status === 2`（审核中）的申请可编辑
- 已审核通过的申请不可编辑

### 删除权限
- 仅限 `audit_status === 2`（审核中）的申请可删除
- 已审核的申请不可删除

## 页面状态说明

### 申请状态（audit_status）
- **0**: 通过 - 申请已通过审核
- **1**: 不通过 - 申请未通过审核
- **2**: 审核中 - 申请正在审核中

### 准入状态（is_auth）
- **0**: 未准入 - 尚未获得准入资格
- **1**: 已准入 - 已获得准入资格
- **2**: 审核中 - 正在审核中

## 技术实现

### 组件使用
- `el-table`: 申请记录列表
- `el-dialog`: 详情查看和编辑对话框
- `el-descriptions`: 详情信息展示
- `el-form`: 编辑表单
- `image-preview`: 图片预览
- `image-upload`: 图片上传
- `ServiceTypeSelector`: 服务类型选择器
- `RegionCascader`: 地区选择器
- `dict-tag`: 字典标签显示

### 数据字典
- `es_org_type`: 组织类型
- `es_sh_jg`: 审核结果
- `es_is_auth`: 准入状态

## 使用说明

1. **查看申请记录**：用户登录后，点击"我的申请"菜单，查看所有申请记录
2. **搜索申请**：使用搜索条件筛选特定的申请记录
3. **查看详情**：点击"查看"按钮查看申请的完整信息
4. **编辑申请**：对于审核中的申请，可以点击"编辑"按钮修改信息
5. **删除申请**：对于审核中的申请，可以点击"删除"按钮删除申请
6. **新增申请**：点击"新增申请"按钮跳转到申请页面

## 注意事项

1. **API 接口**：目前使用临时接口，需要后端实现对应的 API 端点
2. **权限控制**：编辑和删除操作仅限审核中的申请
3. **数据验证**：编辑表单包含必要的验证规则
4. **图片处理**：支持多图片上传和预览
5. **状态显示**：使用字典标签显示状态信息

## 后续优化建议

1. **API 实现**：后端需要实现 `/subject/servicer/my` 接口
2. **权限细化**：可以进一步细化用户权限控制
3. **状态流转**：可以添加申请状态流转的说明
4. **消息通知**：可以添加申请状态变更的消息通知
5. **导出功能**：可以添加申请记录的导出功能
